(function(){if(window.BlutecAPIScr)return;const g=6371010,I=256,A=27.3611*g*768;function b(n,e){const r=e*Math.PI/180;return A*Math.cos(r)/(Math.pow(2,n)*I)}function f(n,e,r,t=0){return`!4m12!1m3!1d${b(r,n)}!2d${e}!3d${n}!2m3!1f0!2f0!3f0!3m2!1i1440!2i333!4f13.1!7i20!8i${t}!10b1!12m25!1m5!18b1!30b1!31m1!1b1!34e1!2m3!5m1!6e2!20e3!10b1!12b1!13b1!16b1!17m1!3e1!20m4!5e2!6b1!8b1!14b1!46m1!1b0!96b1!99b1!19m4!2m3!1i360!2i120!4i8!20m65!2m2!1i203!2i100!3m2!2i4!5b1!6m6!1m2!1i86!2i86!1m2!1i408!2i240!7m33!1m3!1e1!2b0!3e3!1m3!1e2!2b1!3e2!1m3!1e2!2b0!3e3!1m3!1e8!2b0!3e3!1m3!1e10!2b0!3e3!1m3!1e10!2b1!3e2!1m3!1e10!2b0!3e4!1m3!1e9!2b1!3e2!2b1!9b0!15m16!1m7!1m2!1m1!1e2!2m2!1i195!2i195!3i20!1m7!1m2!1m1!1e2!2m2!1i195!2i195!3i20!22m6!1s${encodeURIComponent("session_token")}!2s1i%3A0%2Ct%3A11887!7e81!12e3!17ssession!18e15`}async function p(n,e,r,t,s=0){try{const o=`https://www.google.com/search?tbm=map&authuser=0&hl=en&gl=in&pb=${f(e,r,t,s)}&q=${encodeURIComponent(n)}`,m=await(await fetch(o,{method:"GET",headers:{Accept:"*/*","Accept-Language":"en-US,en;q=0.9","User-Agent":navigator.userAgent}})).text();return w(m)}catch(a){return console.error("[API] Fetch error:",a),[]}}function w(n){const e=[];try{const r=n.match(/window\.APP_INITIALIZATION_STATE=(.*?);window\.APP_FLAGS=/s);if(r)try{const o=JSON.parse(r[1]);P(o,e)}catch(o){console.warn("[API] Failed to parse APP_INITIALIZATION_STATE:",o)}const t=n.matchAll(/\["([^"]+)","([^"]+)","([^"]*)".*?\[null,null,([\d.-]+),([\d.-]+)\]/g);for(const o of t){const[,c,m,l,u,d]=o;c&&c.length>2&&e.push({name:i(c),address:i(m),phone:i(l),latitude:u,longitude:d})}const s=/"([^"]{10,100})","([^"]+)","([^"]*)",\[null,null,([\d.]+),([\d.]+)\]/g;let a;for(;(a=s.exec(n))!==null;){const[,o,c,m,l,u]=a;o&&!e.find(d=>d.name===o)&&e.push({name:i(o),category:i(c),address:i(m),latitude:parseFloat(l),longitude:parseFloat(u)})}}catch(r){console.error("[API] Parse error:",r)}return e}function P(n,e){function r(t){if(t){if(Array.isArray(t))for(const s of t)r(s);else if(typeof t=="object"){t.name&&t.geometry&&e.push({name:t.name,address:t.address||"",phone:t.phoneNumber||"",website:t.website||"",rating:t.rating||"",reviews:t.userRatingsTotal||""});for(const s in t)r(t[s])}}}r(n)}function i(n){if(!n)return"";const e=document.createElement("textarea");return e.innerHTML=n,e.value}function h(){try{const e=window.location.href.match(/@(-?\d+\.\d+),(-?\d+\.\d+),(\d+\.?\d*)z/);return e?{latitude:parseFloat(e[1]),longitude:parseFloat(e[2]),zoom:parseFloat(e[3])}:{latitude:19.076,longitude:72.8777,zoom:12}}catch(n){return console.error("[API] Error getting coords:",n),{latitude:19.076,longitude:72.8777,zoom:12}}}async function E(n,e=5){const r=h(),t=[];for(let s=0;s<e;s++){const a=s*20,o=await p(n,r.latitude,r.longitude,r.zoom,a);if(o.length>0)t.push(...o);else break;await new Promise(c=>setTimeout(c,1e3))}return t}window.BlutecAPIScr={scrapeWithAPI:E,fetchMapData:p,generatePbParameter:f,getCurrentMapCoords:h}})();
