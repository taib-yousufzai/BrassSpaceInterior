import{r as a,s as G,j as e,c as ce,R as xe}from"../assets/subscriptionApi-CTjlMh7J.js";import{g as ue,a as me,b as he,v as ge,r as pe,c as be,d as fe,l as we,e as je,f as ve,u as te}from"../assets/api-CaQDPjnL.js";import{l as re,S as ye}from"../assets/SubscriptionLimitAlert-XUnO6yrR.js";const ae=a.createContext(),H=()=>{const i=a.useContext(ae);if(!i)throw new Error("useAuth must be used within an AuthProvider");return i},Ne=({children:i})=>{const[j,o]=a.useState(null),[u,t]=a.useState(!1),[h,g]=a.useState(!0),[D,N]=a.useState(null),[m,L]=a.useState(null);a.useEffect(()=>{C()},[]);const C=async()=>{try{const p=await ue(),k=await me(),E=await he();if(p&&k)try{const S=await ge();S.success&&S.user?(o(S.user),t(!0),N(S.user.subscription_status),await r()):await d()}catch(S){console.error("Token verification error:",S),await d()}else await d()}catch(p){console.error("Initialize auth error:",p),await d()}finally{g(!1)}},M=async(p,k)=>{try{const E=await je(p.email,p.name,p.picture);if(E.success)return o(E.user),t(!0),N(E.user.subscription_status),await r(),{success:!0};throw new Error(E.message||"Login failed")}catch(E){return console.error("Sign in error:",E),{success:!1,error:E.message}}},z=async()=>{try{await we()}catch(p){console.error("Sign out error:",p)}finally{await d()}},d=async()=>{await pe(),await be(),await chrome.storage.local.remove(["subscriptionStatus"]),o(null),t(!1),N(null)},x=async()=>{try{const p=await fe();return p.success?(N(p.subscription_status),p):null}catch(p){return console.error("Check subscription error:",p),null}},r=async()=>{try{const p=await G.getMySubscription();p.success&&L(p)}catch(p){console.error("Fetch subscription data error:",p)}},A={user:j,isAuthenticated:u,isLoading:h,subscriptionStatus:D,subscriptionData:m,signIn:M,signOut:z,checkSubscription:x,refreshSubscriptionStatus:async()=>{await x(),await r()},fetchSubscriptionData:r};return e.jsx(ae.Provider,{value:A,children:i})},oe=()=>{const{signIn:i,isAuthenticated:j}=H(),[o,u]=a.useState(!1),[t,h]=a.useState("");a.useEffect(()=>{},[j]);const g=async()=>{u(!0),h("");try{const D=chrome.runtime.getManifest(),N=chrome.identity.getRedirectURL().replace(/\/$/,""),m=new URL("https://accounts.google.com/o/oauth2/auth");m.searchParams.set("client_id",D.oauth2.client_id),m.searchParams.set("response_type","token"),m.searchParams.set("redirect_uri",N),m.searchParams.set("scope",D.oauth2.scopes.join(" ")),m.searchParams.set("prompt","select_account"),chrome.identity.launchWebAuthFlow({url:m.href,interactive:!0},async L=>{var C;if(chrome.runtime.lastError||!L){console.error("Auth error:",chrome.runtime.lastError),h(((C=chrome.runtime.lastError)==null?void 0:C.message)||"Authentication failed"),u(!1);return}try{const M=new URL(L),d=new URLSearchParams(M.hash.substring(1)).get("access_token");if(!d){h("Failed to get authentication token"),u(!1);return}const x=await fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:`Bearer ${d}`}});if(!x.ok)throw new Error("Failed to fetch user info");const r=await x.json(),B={id:r.id,email:r.email,name:r.name,picture:r.picture,given_name:r.given_name,family_name:r.family_name},A=await i(B,d);A.success||(h(A.error||"Failed to sign in"),u(!1))}catch(M){console.error("Error fetching user info:",M),h("Failed to retrieve user information"),u(!1)}})}catch(D){console.error("Google Sign-In error:",D),h("Failed to sign in. Please try again."),u(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-[#6FBADB] to-[#4A9FCD] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl p-8 w-full max-w-md",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx("img",{src:re,alt:"Blutec Scout Logo",className:"h-32 w-32 object-contain drop-shadow-lg"})}),e.jsx("div",{className:"text-center mb-6",children:e.jsx("p",{className:"text-lg font-bold text-[#15c5f7] italic",children:'"If it Exists, You can find it"'})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Welcome Back"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Sign in to extract business leads"})]}),t&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 rounded-lg p-3 mb-4",children:e.jsx("p",{className:"text-red-700 text-sm font-medium",children:t})}),e.jsx("button",{onClick:g,disabled:o,className:"w-full bg-white border-2 border-gray-300 hover:border-[#15c5f7] rounded-xl px-6 py-3.5 font-medium text-gray-700 hover:text-[#15c5f7] focus:outline-none focus:ring-4 focus:ring-[#15c5f7]/30 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 shadow-md hover:shadow-lg group",children:o?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-[#15c5f7] border-t-transparent mr-3"}),e.jsx("span",{className:"text-base",children:"Signing in..."})]}):e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"w-5 h-5 mr-3 transition-transform group-hover:scale-110",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),e.jsx("span",{className:"text-base",children:"Continue with Google"})]})}),e.jsxs("p",{className:"text-center text-xs text-gray-500 mt-5",children:["By signing in, you agree to our"," ",e.jsx("span",{className:"text-[#15c5f7] hover:underline cursor-pointer",children:"Terms"})," & ",e.jsx("span",{className:"text-[#15c5f7] hover:underline cursor-pointer",children:"Privacy Policy"})]}),e.jsx("div",{className:"text-center mt-4 pt-4 border-t border-gray-100",children:e.jsxs("p",{className:"text-xs text-gray-400",children:["Powered by"," ",e.jsx("span",{className:"font-semibold text-[#15c5f7]",children:"Blutec Scout"})]})})]})})},Me=({activeTab:i,setActiveTab:j})=>{var d;const{user:o,signOut:u}=H(),[t,h]=a.useState(!1),[g,D]=a.useState(null),[N,m]=a.useState(!0),L=a.useRef(null);a.useEffect(()=>{(async()=>{if(o)try{m(!0);const r=await G.getMySubscription();r&&r.success&&(D(r),chrome.storage.local.set({subscriptionData:r}))}catch(r){console.error("Failed to load subscription data:",r),chrome.storage.local.get(["subscriptionData"],B=>{B.subscriptionData&&D(B.subscriptionData)})}finally{m(!1)}})()},[o]),a.useEffect(()=>{const x=r=>{L.current&&!L.current.contains(r.target)&&h(!1)};return t&&document.addEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)}},[t]);const C=async()=>{try{await u(),h(!1)}catch(x){console.error("Logout error:",x)}},M=()=>{if(N)return"Loading...";if(!g)return"Free";if(g.hasActiveSubscription){const x=g.subscription;return x&&x.plan_name?x.plan_name:"Active Plan"}return g.trialUsed?"Trial Used":"Free Trial"},z=()=>{if(N)return"text-gray-400";if(!g)return"text-green-500";if(g.hasActiveSubscription){const x=g.subscription;if(x&&x.plan_name){const r=x.plan_name.toLowerCase();return r.includes("enterprise")?"text-purple-500":r.includes("business")?"text-blue-500":r.includes("professional")?"text-green-500":"text-blue-500"}return"text-blue-500"}return g.trialUsed?"text-orange-500":"text-green-500"};return e.jsx("div",{className:"bg-gradient-to-r from-brand-600 to-brand-700 text-white shadow-lg",children:e.jsx("div",{className:"px-4 py-2.5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"bg-white rounded-lg p-2 shadow-md",children:e.jsx("img",{src:re,alt:"BluTec Scout",className:"h-6 w-auto object-contain"})})}),e.jsxs("div",{className:"flex items-center space-x-1 bg-white/10 backdrop-blur-sm rounded-lg px-1 py-1",children:[e.jsxs("button",{onClick:()=>j("home"),className:`flex items-center space-x-1.5 px-3 py-1.5 rounded-md text-xs font-semibold transition-all duration-200 ${i==="home"?"bg-white text-brand-600 shadow-md":"text-white/90 hover:bg-white/15 hover:text-white"}`,children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),e.jsx("span",{children:"Home"})]}),e.jsxs("button",{onClick:()=>j("settings"),className:`flex items-center space-x-1.5 px-3 py-1.5 rounded-md text-xs font-semibold transition-all duration-200 ${i==="settings"?"bg-white text-brand-600 shadow-md":"text-white/90 hover:bg-white/15 hover:text-white"}`,children:[e.jsxs("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("span",{children:"Settings"})]})]}),e.jsxs("div",{className:"relative",ref:L,children:[e.jsxs("button",{onClick:()=>h(!t),className:"flex items-center space-x-2 hover:bg-white/10 rounded-lg px-2 py-1.5 transition-all duration-200",children:[e.jsx("img",{src:(o==null?void 0:o.picture)||"/default-avatar.png",alt:"Profile",className:"w-7 h-7 rounded-full border-2 border-white/30 shadow",onError:x=>{x.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMTYiIGN5PSIxNiIgcj0iMTYiIGZpbGw9IiMxNWM1ZjciLz4KPHBhdGggZD0iTTE2IDE2QzE4LjIwOTEgMTYgMjAgMTQuMjA5MSAyMCAxMkMyMCA5Ljc5MDg2IDE4LjIwOTEgOCAxNiA4QzEzLjc5MDkgOCAxMiA5Ljc5MDg2IDEyIDEyQzEyIDE0LjIwOTEgMTMuNzkwOSAxNiAxNiAxNloiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xNiAxOEMyMC40MTgzIDE4IDI0IDE5LjU4MTcgMjQgMjFIMjVDMjUgMjIuMTA0NiAyNC4xMDQ2IDIzIDIzIDIzSDlDNy44OTU0MyAyMyA3IDIyLjEwNDYgNyAyMUM3IDE5LjU4MTcgMTAuNTgxNyAxOCAxNSAxOEgxNloiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPg=="}}),e.jsxs("div",{className:"text-left hidden sm:block",children:[e.jsx("div",{className:"text-xs font-semibold leading-none",children:((d=o==null?void 0:o.name)==null?void 0:d.split(" ")[0])||"User"}),e.jsx("div",{className:`text-[10px] leading-none mt-0.5 ${z()}`,children:M()})]}),e.jsx("svg",{className:`w-3.5 h-3.5 transition-transform duration-200 ${t?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})]}),t&&e.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-xl shadow-2xl border border-gray-100 py-2 z-50 animate-slide-in",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:(o==null?void 0:o.picture)||"/default-avatar.png",alt:"Profile",className:"w-10 h-10 rounded-full border-2 border-brand-100",onError:x=>{x.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjAiIGN5PSIyMCIgcj0iMjAiIGZpbGw9IiMxNWM1ZjciLz4KPHBhdGggZD0iTTIwIDIwQzIyLjc2MTQgMjAgMjUgMTcuNzYxNCAyNSAxNUMyNSAxMi4yMzg2IDIyLjc2MTQgMTAgMjAgMTBDMTcuMjM4NiAxMCAxNSAxMi4yMzg2IDE1IDE1QzE1IDE3Ljc2MTQgMTcuMjM4NiAyMCAyMCAyMFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0yMCAyMkMyNS41MjI4IDIyIDMwIDIzLjQ3NzIgMzAgMjVIMzFDMzEgMjYuMTA0NiAzMC4xMDQ2IDI3IDI5IDI3SDExQzkuODk1NDMgMjcgOSAyNi4xMDQ2IDkgMjVDOSAyMy40NzcyIDEzLjQ3NzIgMjIgMTkgMjJIMjBaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4="}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-semibold text-gray-900 text-sm truncate",children:(o==null?void 0:o.name)||"User"}),e.jsx("div",{className:"text-xs text-gray-600 truncate",children:(o==null?void 0:o.email)||"user@example.com"}),e.jsxs("div",{className:`inline-flex items-center mt-1 px-1.5 py-0.5 rounded text-[10px] font-semibold ${N?"bg-gray-100 text-gray-500":g?g.hasActiveSubscription?"bg-blue-100 text-blue-700":g.trialUsed?"bg-orange-100 text-orange-700":"bg-green-100 text-green-700":"bg-green-100 text-green-700"}`,children:[e.jsx("svg",{className:"w-2.5 h-2.5 mr-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),M()]})]})]})}),e.jsxs("button",{onClick:C,className:"w-full px-4 py-2.5 text-left text-sm text-red-600 hover:bg-red-50 transition-colors flex items-center space-x-2.5 font-medium",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),e.jsx("span",{children:"Sign Out"})]})]})]})]})})})},se=({onNavigate:i})=>{const j=()=>{chrome.tabs.create({url:"https://www.google.com/maps"})},o=()=>{chrome.tabs.create({url:chrome.runtime.getURL("bulk-keyword.html")})},u=()=>{chrome.tabs.create({url:"https://www.youtube.com/watch?v=IKDpDgDxyPw&t=3s"})};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 max-w-4xl mx-auto",children:[e.jsxs("button",{onClick:j,className:"group relative bg-white/70 backdrop-blur-md rounded-xl shadow-sm hover:shadow-xl transition-all duration-300 p-4 text-left border border-white/20 hover:border-brand-200 hover:scale-[1.02] overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-brand-500/0 to-brand-600/0 group-hover:from-brand-500/5 group-hover:to-brand-600/10 transition-all duration-300 rounded-xl"}),e.jsxs("div",{className:"relative flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-md group-hover:scale-110 transition-transform duration-300",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 mb-1 flex items-center gap-2",children:["Single Keyword Scraper",e.jsx("svg",{className:"w-4 h-4 text-gray-400 group-hover:text-brand-500 group-hover:translate-x-1 transition-all",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),e.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:"Navigate to Google Maps and start searching"})]})]})]}),e.jsxs("button",{onClick:o,className:"group relative bg-white/70 backdrop-blur-md rounded-xl shadow-sm hover:shadow-xl transition-all duration-300 p-4 text-left border border-white/20 hover:border-brand-200 hover:scale-[1.02] overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-brand-500/0 to-brand-600/0 group-hover:from-brand-500/5 group-hover:to-brand-600/10 transition-all duration-300 rounded-xl"}),e.jsxs("div",{className:"relative flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-lg flex items-center justify-center shadow-md group-hover:scale-110 transition-transform duration-300",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 mb-1 flex items-center gap-2",children:["Bulk Keyword Extraction",e.jsx("svg",{className:"w-4 h-4 text-gray-400 group-hover:text-brand-500 group-hover:translate-x-1 transition-all",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),e.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:"Process multiple keywords and extract in bulk"})]})]})]}),e.jsxs("button",{onClick:u,className:"group relative bg-white/70 backdrop-blur-md rounded-xl shadow-sm hover:shadow-xl transition-all duration-300 p-4 text-left border border-white/20 hover:border-brand-200 hover:scale-[1.02] overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-brand-500/0 to-brand-600/0 group-hover:from-brand-500/5 group-hover:to-brand-600/10 transition-all duration-300 rounded-xl"}),e.jsxs("div",{className:"relative flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-gradient-to-br from-rose-500 to-rose-600 rounded-lg flex items-center justify-center shadow-md group-hover:scale-110 transition-transform duration-300",children:e.jsxs("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 mb-1 flex items-center gap-2",children:["Tutorial Video",e.jsx("svg",{className:"w-4 h-4 text-gray-400 group-hover:text-brand-500 group-hover:translate-x-1 transition-all",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),e.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:"Watch step-by-step guide on how to use"})]})]})]})]}),e.jsx("div",{className:"mt-4 max-w-4xl mx-auto",children:e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-white/50 backdrop-blur-sm rounded-lg p-3 border border-white/20 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-brand-600",children:"Fast"}),e.jsx("div",{className:"text-[10px] text-gray-600 mt-0.5",children:"Ultra Speed"})]}),e.jsxs("div",{className:"bg-white/50 backdrop-blur-sm rounded-lg p-3 border border-white/20 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-brand-600",children:"Accurate"}),e.jsx("div",{className:"text-[10px] text-gray-600 mt-0.5",children:"Precise Data"})]}),e.jsxs("div",{className:"bg-white/50 backdrop-blur-sm rounded-lg p-3 border border-white/20 text-center",children:[e.jsx("div",{className:"text-xl font-bold text-brand-600",children:"Easy"}),e.jsx("div",{className:"text-[10px] text-gray-600 mt-0.5",children:"Simple Setup"})]})]})})]})},ke=()=>{const{user:i,signOut:j}=H(),[o,u]=a.useState("general"),[t,h]=a.useState({fileFormat:"csv",autoDownload:!0,downloadMode:"entire",downloadPath:"",googleDriveSync:!1}),[g,D]=a.useState(!0),[N,m]=a.useState(!1),[L,C]=a.useState(""),[M,z]=a.useState(null),[d,x]=a.useState({visible:!1,type:"info",message:""}),[r,B]=a.useState(null),[A,p]=a.useState(!0),[k,E]=a.useState({remaining:0,total:0,used:0,loading:!0}),S=(l,y="info",s=2200)=>{x({visible:!0,type:y,message:l}),window.clearTimeout(S._t),S._t=window.setTimeout(()=>x({visible:!1,type:y,message:""}),s)},_=a.useMemo(()=>M?t.fileFormat!==M.fileFormat||t.autoDownload!==M.autoDownload||t.downloadMode!==M.downloadMode||t.googleDriveSync!==M.googleDriveSync:!1,[t,M]);a.useEffect(()=>{(async()=>{try{D(!0),C("");const y=await ve();if(y&&y.success&&y.settings){const s=y.settings,b={fileFormat:s.file_format||"csv",autoDownload:s.auto_download===!0||s.auto_download===1||s.auto_download==="1",downloadMode:s.download_mode||"entire",downloadPath:s.download_path||"",googleDriveSync:!!s.google_drive_sync};(s.auto_download===!1||s.auto_download===0)&&!s.download_mode&&te({file_format:b.fileFormat,auto_download:!0,download_mode:"entire",download_path:b.downloadPath,google_drive_sync:b.googleDriveSync}).catch(Q=>{console.error("Failed to update settings to new defaults:",Q)}),h(b),z(b),chrome.storage.local.set({settings:b})}else chrome.storage.local.get(["settings"],s=>{if(s.settings){const b={...s.settings,downloadMode:s.settings.downloadMode||"entire",autoDownload:s.settings.autoDownload!==void 0?s.settings.autoDownload:!0};s.settings.downloadMode==="keyword"&&!s.settings.downloadMode_updated&&(b.downloadMode="entire",chrome.storage.local.set({settings:b})),h(b),z(b)}});p(!0);try{const s=await G.getMySubscription();s&&s.success&&(B(s),chrome.storage.local.set({subscriptionData:s}))}catch(s){console.error("Failed to load subscription data:",s),chrome.storage.local.get(["subscriptionData"],b=>{b.subscriptionData&&B(b.subscriptionData)})}finally{p(!1)}E(s=>({...s,loading:!0}));try{const s=await G.checkLeadUsage();s.success&&E({remaining:s.remaining,total:s.total,used:s.used||0,loading:!1})}catch(s){console.error("Failed to load lead usage:",s),E(b=>({...b,loading:!1}))}}catch(y){console.error("Failed to load settings:",y),C("Failed to load settings"),chrome.storage.local.get(["settings"],s=>{if(s.settings){const b={...s.settings,downloadMode:s.settings.downloadMode||"entire",autoDownload:s.settings.autoDownload!==void 0?s.settings.autoDownload:!0};s.settings.downloadMode==="keyword"&&!s.settings.downloadMode_updated&&(b.downloadMode="entire",chrome.storage.local.set({settings:b})),h(b),z(b)}})}finally{D(!1)}})()},[]);const U=a.useCallback((l,y)=>{h(s=>{const b={...s,[l]:y};return chrome.storage.local.set({settings:b}),b})},[]),K=()=>{try{typeof chrome<"u"&&chrome.tabs&&chrome.tabs.create?chrome.tabs.create({url:"chrome://settings/downloads"}):window.open("chrome://settings/downloads","_blank")}catch(l){console.error("Failed to open Chrome download settings",l),S("âœ— Unable to open Chrome settings","error")}},V=async()=>{try{await j()}catch(l){console.error("Logout error:",l)}},F=()=>{if(!r)return{type:"none",name:"No Plan",color:"gray"};if(r.hasActiveSubscription){const l=r.subscription;return l&&l.plan_name?{type:"active",name:l.plan_name,color:l.plan_name.toLowerCase().includes("enterprise")?"purple":l.plan_name.toLowerCase().includes("business")?"blue":l.plan_name.toLowerCase().includes("professional")?"green":"blue"}:{type:"active",name:"Active Plan",color:"blue"}}return r.trialUsed?{type:"trial_used",name:"Trial Used",color:"orange"}:{type:"trial_available",name:"Free Trial Available",color:"green"}},Z=()=>r&&r.hasActiveSubscription?{leads:r.remainingLeads||0,days:r.remainingDays||0,type:"subscription"}:null,W=l=>new Intl.NumberFormat("en-IN").format(l),Y=[{id:"general",label:"General",icon:"âš™ï¸"},{id:"export",label:"Export",icon:"ðŸ“¥"},{id:"integrations",label:"Integrations",icon:"ðŸ”—"}],P=async()=>{try{m(!0),C("");const l={file_format:t.fileFormat,auto_download:t.autoDownload,download_mode:t.downloadMode,google_drive_sync:t.googleDriveSync},y=await te(l);if(y!=null&&y.success){const s={...t};z(s),chrome.storage.local.set({settings:s}),S("âœ“ Settings saved successfully","success")}else throw new Error((y==null?void 0:y.message)||"Save failed")}catch(l){console.error("Save settings error:",l),C("Failed to save settings"),S("âœ— Failed to save settings","error")}finally{m(!1)}};return e.jsx("div",{className:"h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-2 flex flex-col overflow-hidden",children:e.jsxs("div",{className:"max-w-5xl mx-auto w-full flex flex-col h-full",children:[e.jsx("div",{className:"flex gap-1.5 mb-2 flex-shrink-0",children:Y.map(l=>e.jsxs("button",{onClick:()=>u(l.id),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all ${o===l.id?"bg-white shadow-md text-brand-600 border border-brand-200":"bg-white/50 text-gray-600 hover:bg-white/80 border border-transparent"}`,children:[e.jsx("span",{className:"text-sm",children:l.icon}),e.jsx("span",{children:l.label})]},l.id))}),L&&e.jsx("div",{className:"mb-1.5 text-xs text-red-600 bg-red-50 border border-red-200 rounded p-1.5",children:L}),e.jsxs("div",{className:"bg-white/70 backdrop-blur-md rounded-xl shadow-lg border border-white/20 flex-1 flex flex-col overflow-hidden",children:[g&&e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 text-xs",children:[e.jsxs("svg",{className:"animate-spin h-3.5 w-3.5 text-brand-600",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),e.jsx("span",{children:"Loading settingsâ€¦"})]})}),!g&&o==="general"&&e.jsxs("div",{className:"p-3 space-y-2.5",children:[e.jsx("h2",{className:"text-base font-bold text-gray-900 mb-2",children:"Profile Information"}),e.jsxs("div",{className:"flex items-center gap-2.5 p-2 bg-gradient-to-r from-brand-50 to-blue-50 rounded-lg border border-brand-100",children:[e.jsx("img",{src:(i==null?void 0:i.picture)||"/default-avatar.png",alt:"Profile",className:"w-10 h-10 rounded-full border-2 border-brand-300 shadow",onError:l=>{l.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHZpZXdCb3g9IjAgMCA0OCA0OCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjQiIGN5PSIyNCIgcj0iMjQiIGZpbGw9IiMxNWM1ZjciLz4KPHBhdGggZD0iTTI0IDI0QzI3LjMxMzcgMjQgMzAgMjEuMzEzNyAzMCAxOEMzMCAxNC42ODYzIDI3LjMxMzcgMTIgMjQgMTJDMjAuNjg2MyAxMiAxOCAxNC42ODYzIDE4IDE4QzE4IDIxLjMxMzcgMjAuNjg2MyAyNCAyNCAyNFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0yNCAyNkMyOS41MjI4IDI2IDM0IDI3LjQ3NzIgMzQgMjlIMzZDMzYgMzAuMTA0NiAzNS4xMDQ2IDMxIDM0IDMxSDE0QzEyLjg5NTQgMzEgMTIgMzAuMTA0NiAxMiAyOUMxMiAyNy40NzcyIDE2LjQ3NzIgMjYgMjIgMjZIMjRaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4="}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs font-bold text-gray-900",children:(i==null?void 0:i.name)||"User"}),e.jsx("div",{className:"text-[10px] text-gray-600",children:(i==null?void 0:i.email)||"user@example.com"})]}),A?e.jsx("div",{className:"px-1.5 py-0.5 bg-gray-300 text-white rounded text-[9px] font-semibold animate-pulse",children:"Loading..."}):e.jsx("div",{className:`px-1.5 py-0.5 text-white rounded text-[9px] font-semibold ${F().color==="green"?"bg-green-500":F().color==="blue"?"bg-blue-500":F().color==="purple"?"bg-purple-500":F().color==="orange"?"bg-orange-500":"bg-gray-500"}`,children:F().name})]}),!A&&r&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"p-2.5 bg-gradient-to-r from-gray-50 to-blue-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-700",children:"Current Plan"}),e.jsx("span",{className:`text-xs font-bold ${F().color==="green"?"text-green-600":F().color==="blue"?"text-blue-600":F().color==="purple"?"text-purple-600":F().color==="orange"?"text-orange-600":"text-gray-600"}`,children:F().name})]}),Z()&&e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[10px]",children:[e.jsxs("div",{className:"bg-white p-1.5 rounded border",children:[e.jsx("div",{className:"text-gray-600",children:"Remaining Leads"}),e.jsx("div",{className:"font-bold text-gray-900",children:W(Z().leads)})]}),e.jsxs("div",{className:"bg-white p-1.5 rounded border",children:[e.jsx("div",{className:"text-gray-600",children:"Days Left"}),e.jsx("div",{className:"font-bold text-gray-900",children:Z().days})]})]}),!k.loading&&e.jsxs("div",{className:"mt-2 p-2 bg-gradient-to-r from-blue-50 to-indigo-50 rounded border border-blue-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-[10px] font-semibold text-blue-800",children:"Lead Usage"}),e.jsxs("span",{className:"text-[9px] text-blue-600",children:[k.used," / ",k.total]})]}),e.jsx("div",{className:"w-full bg-blue-200 rounded-full h-1.5 mb-1",children:e.jsx("div",{className:"bg-blue-500 h-1.5 rounded-full transition-all duration-300",style:{width:`${k.used/k.total*100}%`}})}),e.jsxs("div",{className:"text-[9px] text-blue-700",children:[k.remaining," leads remaining"]})]}),r.trialUsed&&!r.hasActiveSubscription&&e.jsx("div",{className:"mt-1.5 p-1.5 bg-orange-50 border border-orange-200 rounded text-[10px] text-orange-800",children:"âš ï¸ Your free trial has expired. Upgrade to continue extracting leads."}),!r.hasActiveSubscription&&!r.trialUsed&&e.jsx("div",{className:"mt-1.5 p-1.5 bg-green-50 border border-green-200 rounded text-[10px] text-green-800",children:"ðŸŽ‰ You're eligible for a 7-day free trial with 1,000 leads!"})]}),e.jsxs("div",{className:"flex gap-1.5",children:[e.jsxs("button",{onClick:()=>window.open("chrome-extension://"+chrome.runtime.id+"/subscription-plans.html","_blank"),className:"flex-1 py-1.5 bg-gradient-to-r from-brand-500 to-brand-600 text-white rounded-lg text-xs font-semibold hover:from-brand-600 hover:to-brand-700 transition-all shadow-md hover:shadow-lg flex items-center justify-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),e.jsx("span",{children:"View Plans"})]}),r.hasActiveSubscription&&e.jsxs("button",{onClick:()=>{S("Subscription management coming soon!","info")},className:"px-3 py-1.5 bg-gray-500 text-white rounded-lg text-xs font-semibold hover:bg-gray-600 transition-all flex items-center justify-center gap-1",children:[e.jsxs("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("span",{children:"Manage"})]})]})]}),e.jsx("div",{className:"pt-2 border-t border-gray-200",children:e.jsxs("button",{onClick:V,className:"w-full py-2 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg text-xs font-semibold hover:from-red-600 hover:to-red-700 transition-all shadow-md hover:shadow-lg flex items-center justify-center gap-1.5",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),e.jsx("span",{children:"Logout"})]})})]}),!g&&o==="export"&&e.jsxs("div",{className:"p-3 h-full flex flex-col",children:[e.jsx("h2",{className:"text-base font-bold text-gray-900 mb-2 flex-shrink-0",children:"Export Configuration"}),e.jsxs("div",{className:"flex-1 overflow-y-auto space-y-2.5 pr-1",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-semibold text-gray-700",children:"File Format"}),e.jsx("div",{className:"grid grid-cols-3 gap-1.5",children:["csv","xlsx","json"].map(l=>e.jsx("button",{onClick:()=>U("fileFormat",l),className:`py-1.5 rounded-lg text-xs font-semibold transition-all ${t.fileFormat===l?"bg-brand-500 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:l.toUpperCase()},l))})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-gray-900",children:"Auto Download"}),e.jsx("div",{className:"text-[9px] text-gray-600",children:"Download files automatically after extraction"})]}),e.jsx("button",{type:"button",onClick:()=>U("autoDownload",!t.autoDownload),className:`relative inline-flex h-5 w-10 flex-shrink-0 cursor-pointer rounded-full transition-colors duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-brand-500 focus:ring-offset-2 ${t.autoDownload?"bg-brand-500":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-md transition duration-300 ease-in-out ${t.autoDownload?"translate-x-5":"translate-x-0.5"}`,style:{marginTop:"2px"}})})]}),t.autoDownload&&e.jsxs("div",{className:"space-y-1 p-2 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("label",{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),"Choose where to download"]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("div",{className:"text-[9px] text-gray-700 bg-white p-1.5 rounded border border-blue-200",children:'By default, files save to your Downloads folder. To choose a folder each time, enable "Ask where to save each file" in Chrome.'}),e.jsxs("ol",{className:"list-decimal ml-4 text-[10px] text-gray-700 space-y-0.5",children:[e.jsx("li",{children:"Open Chrome download settings"}),e.jsx("li",{children:'Turn on "Ask where to save each file"'})]}),e.jsxs("button",{onClick:K,className:"w-full py-1.5 bg-blue-600 text-white rounded-lg text-xs font-semibold hover:bg-blue-700 transition-colors flex items-center justify-center gap-1.5",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2a2 2 0 012-2h6M9 7h6a2 2 0 012 2v8M5 7h.01M5 17h.01"})}),"Open Chrome download settings"]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-semibold text-gray-700",children:"Download Mode"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[e.jsxs("button",{onClick:()=>U("downloadMode","keyword"),className:`p-2 rounded-lg text-xs transition-all ${t.downloadMode==="keyword"?"bg-brand-500 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx("div",{className:"font-semibold mb-0.5",children:"Keyword Wise"}),e.jsx("div",{className:"text-[9px] opacity-90",children:"Separate file per keyword"})]}),e.jsxs("button",{onClick:()=>U("downloadMode","entire"),className:`p-2 rounded-lg text-xs transition-all ${t.downloadMode==="entire"?"bg-brand-500 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx("div",{className:"font-semibold mb-0.5",children:"Entire File"}),e.jsx("div",{className:"text-[9px] opacity-90",children:"Single combined file"})]})]})]})]})]}),!g&&o==="integrations"&&e.jsxs("div",{className:"p-3 h-full flex flex-col",children:[e.jsx("h2",{className:"text-base font-bold text-gray-900 mb-2",children:"Cloud Integrations"}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-2.5 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-9 h-9 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow",children:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12.01 1.485c-.116 0-.232.032-.334.095L1.917 7.555a.666.666 0 000 1.155l9.76 5.975a.667.667 0 00.666 0l9.76-5.975a.666.666 0 000-1.155l-9.76-5.975a.666.666 0 00-.332-.095zM2.25 13.155v2.683c0 .251.138.482.361.605l9.76 5.975c.099.06.211.093.324.097V16.62l-8.974-5.494-1.471.9v1.13z"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-bold text-gray-900",children:"Google Drive"}),e.jsx("div",{className:"text-[10px] text-gray-600",children:"Auto-upload files to Google Drive"})]})]}),e.jsx("button",{type:"button",onClick:()=>U("googleDriveSync",!t.googleDriveSync),className:`relative inline-flex h-5 w-10 flex-shrink-0 cursor-pointer rounded-full transition-colors duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-brand-500 focus:ring-offset-2 ${t.googleDriveSync?"bg-brand-500":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white shadow-md transition duration-300 ease-in-out ${t.googleDriveSync?"translate-x-5":"translate-x-0.5"}`,style:{marginTop:"2px"}})})]}),t.googleDriveSync&&e.jsxs("div",{className:"pt-1.5 border-t border-gray-200",children:[e.jsx("button",{className:"w-full py-1.5 bg-blue-500 text-white rounded-lg text-xs font-semibold hover:bg-blue-600 transition-colors",children:"Connect Google Drive"}),e.jsx("div",{className:"mt-1.5 p-1.5 bg-blue-50 rounded text-[10px] text-blue-800",children:'â„¹ï¸ Files will be saved to "Blutec Scout" folder in your Drive'})]})]})]})]}),_&&e.jsx("button",{onClick:P,disabled:N,className:`fixed top-16 right-4 px-4 py-2 text-white rounded-lg text-xs font-semibold transition-all shadow-lg hover:shadow-xl flex items-center gap-1.5 z-50 ${N?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r from-brand-500 to-brand-600 hover:from-brand-600 hover:to-brand-700 animate-pulse"}`,children:N?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-3.5 w-3.5",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),e.jsx("span",{children:"Savingâ€¦"})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),e.jsx("span",{children:"Save"})]})}),d.visible&&e.jsx("div",{className:`fixed bottom-3 left-1/2 -translate-x-1/2 px-3 py-1.5 rounded-lg shadow-lg text-xs font-semibold z-50 ${d.type==="success"?"bg-green-600 text-white":d.type==="error"?"bg-red-600 text-white":"bg-gray-800 text-white"}`,children:d.message})]})})},Se=({query:i,onQuickScrape:j})=>e.jsx("div",{className:"mx-4 my-3 bg-gradient-to-r from-blue-50 to-sky-50 border-2 border-primary-500 rounded-xl p-3 shadow-sm animate-slide-in",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl flex-shrink-0",children:"ðŸŽ¯"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("strong",{className:"block text-primary-800 text-xs font-bold mb-0.5",children:"Search Detected!"}),e.jsxs("p",{className:"text-xs text-slate-600 m-0 truncate",title:i,children:['"',i,'"']})]}),e.jsx("button",{onClick:j,className:"px-3 py-1.5 bg-primary-500 text-white border-none rounded-lg text-xs font-bold cursor-pointer transition-all duration-200 flex-shrink-0 hover:bg-primary-600 hover:-translate-y-0.5 hover:shadow-lg hover:shadow-primary-500/30 whitespace-nowrap",children:"Quick Scrape"})]})}),De=({searchQuery:i,setSearchQuery:j,location:o,setLocation:u,maxPages:t,setMaxPages:h,scrapeEmails:g,setScrapeEmails:D})=>{const N=m=>{const L=parseInt(m.target.value);h(L)};return e.jsxs("div",{className:"px-4 py-3 border-b border-slate-200",children:[e.jsx("h2",{className:"text-sm font-bold text-primary-800 mb-3",children:"ðŸ” Search Configuration"}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-700",children:"Search Query"}),e.jsx("span",{className:"text-[10px] font-bold px-1.5 py-0.5 bg-primary-500 text-white rounded-full uppercase tracking-wide",children:"Required"})]}),e.jsx("input",{type:"text",value:i,onChange:m=>j(m.target.value),placeholder:"e.g., restaurants in Mumbai",className:"w-full p-2 border-2 border-slate-200 rounded-lg text-xs transition-all duration-200 focus:outline-none focus:border-primary-500 focus:shadow-lg focus:shadow-primary-500/10"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-700",children:"Location"}),e.jsx("span",{className:"text-[10px] font-bold px-1.5 py-0.5 bg-slate-400 text-white rounded-full uppercase tracking-wide",children:"Optional"})]}),e.jsx("input",{type:"text",value:o,onChange:m=>u(m.target.value),placeholder:"e.g., Mumbai, Maharashtra",className:"w-full p-2 border-2 border-slate-200 rounded-lg text-xs transition-all duration-200 focus:outline-none focus:border-primary-500 focus:shadow-lg focus:shadow-primary-500/10"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-700",children:"Max Pages"}),e.jsx("span",{className:"cursor-help text-xs text-slate-500",title:"Each page contains ~20 results",children:"â„¹ï¸"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"range",min:"1",max:"10",value:t,onChange:N,className:"flex-1 h-1.5 rounded-sm bg-slate-200 outline-none appearance-none slider"}),e.jsxs("span",{className:"text-[10px] font-semibold text-primary-600 min-w-[110px] text-right whitespace-nowrap",children:[t," pages (~",t*20," leads)"]})]})]}),e.jsx("div",{className:"mb-3",children:e.jsxs("label",{className:"flex items-start gap-2.5 cursor-pointer p-2.5 border-2 border-slate-200 rounded-lg transition-all duration-200 hover:border-primary-500 hover:bg-slate-50",children:[e.jsx("input",{type:"checkbox",checked:g,onChange:m=>D(m.target.checked),className:"w-4 h-4 mt-0.5 cursor-pointer"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("strong",{className:"block text-slate-700 text-xs mb-0.5 leading-tight",children:"Scrape Emails & Social Links"}),e.jsx("small",{className:"block text-slate-500 text-[10px] leading-relaxed break-words",children:"Extracts emails, Facebook, Instagram, LinkedIn, Twitter"})]})]})})]})},Ie=({onScrape:i,onStopScraping:j,onExport:o,isLoading:u,isScraping:t,hasResults:h})=>e.jsxs("div",{className:"flex gap-2 px-4 py-3",children:[t?e.jsxs("button",{onClick:j,className:"flex-1 px-3 py-2.5 border-none rounded-xl text-xs font-bold cursor-pointer transition-all duration-300 flex items-center justify-center gap-1.5 bg-gradient-to-r from-red-500 to-red-600 text-white shadow-lg shadow-red-500/40 hover:-translate-y-1 hover:shadow-xl hover:shadow-red-500/50 active:translate-y-0 min-w-0",children:[e.jsx("span",{className:"text-base flex-shrink-0",children:"â¹ï¸"}),e.jsx("span",{className:"truncate",children:"Stop Scraping"})]}):e.jsxs("button",{onClick:i,disabled:u,className:"flex-1 px-3 py-2.5 border-none rounded-xl text-xs font-bold cursor-pointer transition-all duration-300 flex items-center justify-center gap-1.5 bg-gradient-to-r from-brand-500 to-brand-600 text-white shadow-lg shadow-brand-500/40 hover:not-disabled:-translate-y-1 hover:not-disabled:shadow-xl hover:not-disabled:shadow-brand-500/50 active:not-disabled:translate-y-0 disabled:bg-slate-300 disabled:cursor-not-allowed disabled:shadow-none min-w-0",children:[e.jsx("span",{className:"text-base flex-shrink-0",children:u?"â³":"ðŸš€"}),e.jsx("span",{className:"truncate",children:u?"Scraping...":"Start Scraping"})]}),e.jsxs("button",{onClick:o,disabled:!h,className:"flex-1 px-3 py-2.5 border-none rounded-xl text-xs font-bold cursor-pointer transition-all duration-300 flex items-center justify-center gap-1.5 bg-gradient-to-r from-emerald-500 to-emerald-600 text-white shadow-lg shadow-emerald-500/40 hover:not-disabled:-translate-y-1 hover:not-disabled:shadow-xl hover:not-disabled:shadow-emerald-500/50 disabled:bg-slate-300 disabled:cursor-not-allowed disabled:shadow-none min-w-0",children:[e.jsx("span",{className:"text-base flex-shrink-0",children:"ðŸ“¥"}),e.jsx("span",{className:"truncate",children:"Export CSV"})]})]}),Le=({status:i})=>{const j=()=>{switch(i.type){case"loading":return"border-l-amber-500 bg-gradient-to-r from-amber-50 to-yellow-50";case"success":return"border-l-emerald-500 bg-gradient-to-r from-emerald-50 to-green-50";case"error":return"border-l-red-500 bg-gradient-to-r from-red-50 to-rose-50";default:return"border-l-primary-500 bg-gradient-to-r from-blue-50 to-sky-50"}},o=()=>{switch(i.type){case"loading":return"âš¡";case"success":return"âœ…";case"error":return"âŒ";default:return"ðŸ’¡"}},u=()=>{switch(i.type){case"loading":return"text-amber-900";case"success":return"text-emerald-900";case"error":return"text-red-900";default:return"text-slate-700"}};return e.jsx("div",{className:`mx-4 mb-4 p-4 border-l-4 rounded-lg shadow-sm transition-all duration-300 ${j()}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-2xl flex-shrink-0",children:o()}),e.jsx("p",{className:`text-sm font-medium m-0 flex-1 min-w-0 leading-relaxed break-words ${u()}`,children:i.message})]})})},Ae=({progress:i})=>e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-sky-50 border-l-4 border-primary-500 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsx("span",{className:"text-2xl flex-shrink-0",children:"ðŸ“Š"}),e.jsx("span",{className:"text-sm font-semibold text-primary-800 truncate",children:i.text})]}),e.jsxs("span",{className:"text-lg font-bold text-primary-600 flex-shrink-0 min-w-[45px] text-right",children:[i.percent,"%"]})]}),e.jsx("div",{className:"h-3 bg-slate-200 rounded-full overflow-hidden shadow-inner",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-primary-500 via-primary-600 to-sky-500 rounded-full transition-all duration-500 ease-out shadow-sm",style:{width:`${i.percent}%`}})})]})}),Ce=({progress:i})=>e.jsx("div",{className:"mx-4 mb-4",children:e.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-yellow-50 border-l-4 border-amber-500 rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx("div",{className:"w-6 h-6 border-3 border-amber-500 border-t-transparent rounded-full animate-spin"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xl flex-shrink-0",children:"âš¡"}),e.jsx("strong",{className:"text-sm font-bold text-amber-900 leading-tight break-words",children:i.text})]}),e.jsx("div",{className:"bg-amber-100 rounded-md px-3 py-1.5 inline-block",children:e.jsx("span",{className:"text-xs font-semibold text-amber-800",children:i.count})})]})]})})}),Ee=()=>e.jsx("div",{className:"p-4 text-center bg-slate-50 border-t border-slate-200",children:e.jsx("p",{className:"text-xs text-slate-400 m-0",children:"Powered by Blutec Scout v10.0 - Complete Edition"})}),ze=({allowClose:i=!1,onClose:j})=>{var L,C,M,z,d,x,r,B;const{user:o,signOut:u,subscriptionData:t}=H(),[h,g]=a.useState(!1),D=()=>{window.open("/subscription-plans.html","_blank")},N=async()=>{await u()},m=A=>new Intl.NumberFormat("en-IN").format(A);return e.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-[#6FBADB] via-[#5AB0D4] to-[#4A9FCD] flex items-center justify-center z-50 p-3",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md max-h-[95vh] overflow-y-auto",children:[e.jsxs("div",{className:"bg-gradient-to-br from-[#6FBADB] to-[#4A9FCD] text-center py-4 px-4 relative",children:[i&&j&&e.jsx("button",{onClick:j,className:"absolute top-3 right-3 text-white hover:bg-white/20 rounded-full p-1.5 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 bg-white/20 backdrop-blur-sm rounded-full mb-2",children:e.jsx("div",{className:"text-3xl",children:"ðŸš€"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:"Choose Your Plan"}),e.jsx("p",{className:"text-white/90 text-sm",children:"Start extracting leads and grow your business"})]}),e.jsxs("div",{className:"p-4",children:[o&&e.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 rounded-lg p-3 mb-3 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-2.5",children:[o.picture&&e.jsx("img",{src:o.picture,alt:o.name,className:"w-11 h-11 rounded-full border-2 border-white shadow-sm"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-gray-900 text-sm truncate",children:o.name}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:o.email})]})]})}),t!=null&&t.hasActiveSubscription?e.jsx("div",{className:"bg-emerald-50 border-2 border-emerald-300 rounded-lg p-3 mb-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-emerald-500 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-base font-bold text-emerald-900 mb-1.5",children:"Active Subscription"}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-xs font-medium text-emerald-800",children:((L=t.subscription)==null?void 0:L.subscription_type)==="trial"?e.jsxs(e.Fragment,{children:["ðŸŽ Free Trial - ",t.remainingDays," days left"]}):e.jsxs(e.Fragment,{children:["ðŸ’Ž ",(C=t.subscription)==null?void 0:C.plan_name," Plan - ",t.remainingDays," days left"]})}),e.jsxs("div",{className:"bg-white rounded-md p-2",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-600 mb-1",children:"Leads Usage"}),e.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[e.jsxs("span",{className:"text-xs font-bold text-gray-900",children:[m(((M=t.subscription)==null?void 0:M.leads_used)||0)," / ",m(((z=t.subscription)==null?void 0:z.lead_limit)||0)]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[Math.round((((d=t.subscription)==null?void 0:d.leads_used)||0)/(((x=t.subscription)==null?void 0:x.lead_limit)||1)*100),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-emerald-500 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(100,(((r=t.subscription)==null?void 0:r.leads_used)||0)/(((B=t.subscription)==null?void 0:B.lead_limit)||1)*100)}%`}})})]})]})]})]})}):e.jsx("div",{className:"bg-gradient-to-br from-yellow-50 to-orange-50 border-2 border-yellow-300 rounded-lg p-4 mb-3 shadow-sm",children:e.jsxs("div",{className:"text-center mb-3",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-gradient-to-br from-yellow-500 to-orange-500 mb-2 shadow-md",children:e.jsx("span",{className:"text-2xl",children:"âš ï¸"})}),e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-1",children:"No Active Subscription"}),e.jsx("p",{className:"text-xs text-gray-700 leading-snug",children:"Your trial may have expired or you don't have an active plan."}),e.jsx("p",{className:"text-xs font-bold text-orange-600 mt-0.5",children:"Upgrade to continue extracting leads!"})]})}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-cyan-50 border-2 border-blue-200 rounded-lg p-4 mb-3 shadow-sm",children:[e.jsxs("div",{className:"text-center mb-3",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-gradient-to-br from-[#6FBADB] to-[#4A9FCD] mb-2 shadow-md",children:e.jsx("span",{className:"text-2xl",children:"ðŸ’Ž"})}),e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-1",children:"View All Plans"}),e.jsx("p",{className:"text-xs text-gray-700 leading-snug",children:"Select from our premium plans with"}),e.jsx("p",{className:"text-xs font-bold text-[#6FBADB] mt-0.5",children:"50,000 to 1,000,000 leads per month"})]}),e.jsx("button",{onClick:D,className:"w-full bg-gradient-to-r from-[#6FBADB] to-[#4A9FCD] text-white rounded-lg px-4 py-2.5 font-bold text-sm hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02] active:scale-[0.98]",children:"View All Plans â†’"})]}),e.jsx("div",{children:e.jsx("button",{onClick:N,className:"w-full bg-white border-2 border-gray-300 text-gray-700 rounded-lg px-4 py-2 font-semibold text-sm hover:bg-gray-50 hover:border-gray-400 transition-all duration-200",children:"Sign Out"})}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1.5 text-xs text-gray-500 mb-1",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),e.jsx("span",{children:"Need help?"}),e.jsx("a",{href:"mailto:support@blutec.com",className:"text-[#6FBADB] font-semibold hover:underline",children:"support@blutec.com"})]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Secure payments powered by Razorpay"})]})]})]})})},Pe=({children:i,requireSubscription:j=!1})=>{const{isAuthenticated:o,isLoading:u,subscriptionStatus:t,user:h}=H();if(u)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-[#6FBADB] to-[#4A9FCD]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-white border-t-transparent mx-auto mb-4"}),e.jsx("p",{className:"text-white font-medium",children:"Loading..."})]})});if(!o)return e.jsx(oe,{});if(j){if(t==null)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-[#6FBADB] to-[#4A9FCD]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-white border-t-transparent mx-auto mb-4"}),e.jsx("p",{className:"text-white font-medium",children:"Checking subscription..."})]})});if(t===0)return e.jsx(ze,{allowClose:!1})}return i};function Be(){const{user:i,isAuthenticated:j,isLoading:o}=H(),[u,t]=a.useState("home"),[h,g]=a.useState(""),[D,N]=a.useState(""),[m,L]=a.useState(5),[C,M]=a.useState(!0),[z,d]=a.useState({message:"Enter search query or open Google Maps to auto-detect",type:"info"}),[x,r]=a.useState(!1),[B,A]=a.useState(!1),[p,k]=a.useState({show:!1,percent:0,text:""}),[E,S]=a.useState({show:!1,text:"",count:"0/0"}),[_,U]=a.useState([]),[K,V]=a.useState(!1),[F,Z]=a.useState(""),[W,Y]=a.useState({fileFormat:"csv",downloadMode:"entire",autoDownload:!0,downloadPath:""}),[P,l]=a.useState({remaining:0,total:0,used:0,canExtract:!1,subscription:null,trialAvailable:!1,loading:!0}),y=async(v=1)=>{try{const n=await G.checkLeadUsage();return n.success?(l({remaining:n.remaining,total:n.total,used:n.used||0,canExtract:n.canExtract,subscription:n.subscription,trialAvailable:n.trialAvailable,loading:!1}),n.remaining>=v):!1}catch(n){return console.error("[Popup] Failed to check lead limit:",n),!1}},s=async()=>{try{(await G.startTrial()).success&&(alert("Free trial started! You now have 1000 leads available."),await y())}catch(v){console.error("Failed to start trial:",v),alert("Failed to start trial. Please try again.")}},b=()=>{window.open("chrome-extension://"+chrome.runtime.id+"/subscription-plans.html","_blank")},J=()=>{A(!1),r(!1),k({show:!1,percent:0,text:""}),S({show:!1,text:"",count:"0/0"}),d({message:"Scraping stopped by user",type:"info"}),chrome.runtime.sendMessage({action:"stopScraping"})};if(a.useEffect(()=>{const v=()=>{chrome.storage.local.get(["settings"],w=>{w.settings&&Y({fileFormat:w.settings.fileFormat||"csv",downloadMode:w.settings.downloadMode||"entire",autoDownload:w.settings.autoDownload!==!1,downloadPath:w.settings.downloadPath||""})})},n=async()=>{try{l(I=>({...I,loading:!0}));const w=await G.checkLeadUsage();w.success&&l({remaining:w.remaining,total:w.total,used:w.used||0,canExtract:w.canExtract,subscription:w.subscription,trialAvailable:w.trialAvailable,loading:!1})}catch(w){console.error("Failed to load lead usage:",w),l(I=>({...I,loading:!1}))}};v(),n();const f=w=>{w.settings&&v()};return chrome.storage.onChanged.addListener(f),()=>{chrome.storage.onChanged.removeListener(f)}},[]),a.useEffect(()=>{chrome.tabs.query({active:!0,currentWindow:!0},v=>{var n,f;if((f=(n=v[0])==null?void 0:n.url)!=null&&f.includes("google.com/maps/search/"))try{const w=new URL(v[0].url),I=decodeURIComponent(w.pathname.split("/maps/search/")[1].split("/")[0].replace(/\+/g," "));g(I),Z(I)}catch(w){console.error("[Popup] Error parsing URL:",w)}})},[]),a.useEffect(()=>{const v=(n,f,w)=>{if(n.action==="scrapingProgress"&&n.stage==="scraping_places"){const{currentPage:I,totalPages:R,leadsUsed:$,maxLeads:T}=n.progress,c=Math.round(I/R*100);k({show:!0,percent:c,text:`Page ${I}/${R}`}),S({show:!1,text:"",count:"0/0"}),d({message:`ðŸ“ Scraping places: ${$}/${T} leads collected`,type:"loading"})}if(n.action==="placesScrapingComplete"&&(U(n.data),k({show:!1,percent:0,text:""}),d({message:`âœ… Places scraped! Now scraping emails from ${n.stats.websites} websites...`,type:"loading"})),n.action==="emailScrapingProgress"){const{currentBatch:I,totalBatches:R,processedWebsites:$,totalWebsites:T}=n.progress,c=Math.round($/T*100);k({show:!1,percent:0,text:""}),S({show:!0,text:`Scraping emails: Batch ${I}/${R}`,count:`${$}/${T}`}),d({message:`ðŸ“§ Scraping emails... ${c}% complete`,type:"loading"})}if(n.action==="emailBatchComplete"&&U(n.data),n.action==="scrapingComplete"){U(n.data),r(!1),A(!1),k({show:!1,percent:0,text:""}),S({show:!1,text:"",count:"0/0"});const{total:I,phones:R,websites:$,emails:T,totalEmails:c}=n.stats;d({message:`âœ… Extracted ${I} leads! (${R} phones, ${$} websites, ${T} with emails - ${c} total emails)`,type:"success"}),y(),V(!0),W.autoDownload&&setTimeout(()=>{X()},500)}n.action==="scrapingError"&&(console.error("[Popup] Scraping error:",n.error),d({message:`Error: ${n.error}`,type:"error"}),k({show:!1,percent:0,text:""}),S({show:!1,text:"",count:"0/0"}),r(!1),A(!1))};return chrome.runtime.onMessage.addListener(v),()=>{chrome.runtime.onMessage.removeListener(v)}},[W.autoDownload]),o)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl p-8",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),e.jsx("span",{className:"ml-3 text-gray-700",children:"Loading..."})]})})});if(!j)return e.jsx(oe,{});const Q=async()=>{if(!h.trim()){d({message:"Please enter a search query",type:"error"});return}if(!await y(1)){d({message:"âš ï¸ Lead limit reached. Please upgrade your plan or start a free trial.",type:"error"});return}r(!0),A(!0),d({message:"Starting Google Maps extraction...",type:"loading"}),k({show:!0,percent:0,text:"Initializing..."}),S({show:!1,text:"",count:"0/0"});try{chrome.runtime.sendMessage({action:"startScrape",data:{query:h,location:D,maxPages:m}},n=>{if(chrome.runtime.lastError){console.error("[Popup] Runtime error:",chrome.runtime.lastError.message),d({message:"Connection error. Please try again.",type:"error"}),r(!1),A(!1),k({show:!1,percent:0,text:""});return}if(!n||!n.success){d({message:`Error: ${(n==null?void 0:n.error)||"Unknown error"}`,type:"error"}),r(!1),A(!1),k({show:!1,percent:0,text:""});return}})}catch(n){console.error("[Popup] Error:",n),d({message:"Error: "+n.message,type:"error"}),k({show:!1,percent:0,text:""}),r(!1),A(!1)}},X=()=>{if(!_||_.length===0){d({message:"âš ï¸ No results to export",type:"error"});return}if(!W.autoDownload){d({message:"âš ï¸ Auto Download is disabled. Enable in Settings.",type:"error"});return}const v=new Date().toISOString().slice(0,10);switch(W.fileFormat.toLowerCase()){case"csv":q(v);break;case"json":ne(v);break;default:q(v)}},q=v=>{const n=["#","Name","Category","Address","Country Code","Phone","Monday Hours","Tuesday Hours","Wednesday Hours","Thursday Hours","Friday Hours","Saturday Hours","Sunday Hours","Website","Emails","Rating","Reviews","Place ID","Lat","Lng","Directions"],f=c=>{if(!c)return"";const O=String(c).trim();return O.includes(",")?`"${O.replace(/"/g,'""')}"`:O},I="\uFEFF"+[n.join(","),..._.map((c,O)=>{const le=`https://www.google.com/maps?q=${encodeURIComponent(c.latitude+","+c.longitude)}`,de=c.emails&&c.emails.length>0?c.emails.join("; "):"";return c.emails&&c.emails.length,[O+1,f(c.name),f(c.category),f(c.address),f(c.phoneCountryCode||""),f(c.phone),f(c.mondayHours||""),f(c.tuesdayHours||""),f(c.wednesdayHours||""),f(c.thursdayHours||""),f(c.fridayHours||""),f(c.saturdayHours||""),f(c.sundayHours||""),f(c.website),f(de),f(c.rating),f(c.reviewCount),f(c.placeId),c.latitude||"",c.longitude||"",le].join(",")})].join(`
`),R=new Blob([I],{type:"text/csv;charset=utf-8"}),$=URL.createObjectURL(R),T=document.createElement("a");T.href=$,T.download=`blutec_leads_${v}_${_.length}.csv`,T.click(),URL.revokeObjectURL($),d({message:`âœ… CSV exported successfully! (${_.length} leads)`,type:"success"})},ne=v=>{const n=JSON.stringify(_,null,2),f=new Blob([n],{type:"application/json;charset=utf-8"}),w=URL.createObjectURL(f),I=document.createElement("a");I.href=w,I.download=`blutec_leads_${v}_${_.length}.json`,I.click(),URL.revokeObjectURL(w),d({message:`âœ… JSON exported successfully! (${_.length} leads)`,type:"success"})},ee=v=>{t(v)},ie=()=>{switch(u){case"home":return e.jsx(se,{onNavigate:ee});case"settings":return e.jsx(ke,{});case"scraper":return e.jsxs("div",{className:"min-h-screen bg-white",children:[F&&e.jsx(Se,{query:F,onQuickScrape:Q}),e.jsx(De,{searchQuery:h,setSearchQuery:g,location:D,setLocation:N,maxPages:m,setMaxPages:L,scrapeEmails:C,setScrapeEmails:M}),!P.loading&&e.jsxs("div",{className:"px-4 py-3 mt-2 bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-lg mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Lead Usage:"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-green-700",children:[e.jsxs("span",{className:"px-2 py-1 bg-green-100 rounded",children:[P.used," / ",P.total," used"]}),e.jsxs("span",{className:"px-2 py-1 bg-blue-100 rounded",children:[P.remaining," remaining"]}),P.subscription&&e.jsx("span",{className:"px-2 py-1 bg-purple-100 rounded",children:P.subscription.plan_name})]})]}),e.jsx("div",{className:"mt-2 w-full bg-green-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${P.used/P.total*100}%`}})})]}),e.jsx(ye,{remaining:P.remaining,total:P.total,subscription:P.subscription,trialAvailable:P.trialAvailable,onStartTrial:s,onUpgrade:b}),e.jsx(Ie,{onScrape:Q,onStopScraping:J,onExport:X,isLoading:x,isScraping:B,hasResults:_.length>0}),e.jsx(Le,{status:z}),p.show&&e.jsx(Ae,{progress:p}),E.show&&e.jsx(Ce,{progress:E}),e.jsx(Ee,{})]});default:return e.jsx(se,{onNavigate:ee})}};return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(Me,{activeTab:u,setActiveTab:t}),ie()]})}function Fe(){return e.jsx(Ne,{children:e.jsx(Pe,{requireSubscription:!0,children:e.jsx(Be,{})})})}const _e=ce.createRoot(document.getElementById("root"));_e.render(e.jsx(xe.StrictMode,{children:e.jsx(Fe,{})}));
