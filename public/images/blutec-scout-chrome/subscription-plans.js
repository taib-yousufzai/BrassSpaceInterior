import{r as a,s as i,j as e,c as P,R as A}from"./assets/subscriptionApi-CTjlMh7J.js";import{g as B,a as F}from"./assets/api-CaQDPjnL.js";const S=()=>{const[o,u]=a.useState(null),[x,h]=a.useState([]),[m,f]=a.useState(null),[p,g]=a.useState(!0),[b,c]=a.useState(!1),[w,d]=a.useState(null),[D,k]=a.useState(null);a.useEffect(()=>{y()},[]);const y=async()=>{try{const s=await B(),r=await F();if(!s){console.error("âŒ No authentication token found"),alert("Please log in first to view subscription plans."),setTimeout(()=>window.close(),2e3);return}if(!r){console.error("âŒ No user data found"),alert("Unable to load user data. Please try logging in again."),setTimeout(()=>window.close(),2e3);return}r&&u(r);const[t,l]=await Promise.all([i.getPlans().catch(n=>(console.error("Plans API error:",n),{success:!1,error:n.message})),i.getMySubscription().catch(n=>(console.error("Subscription API error:",n),{success:!1,error:n.message}))]);t&&t.success&&t.plans?h(t.plans):(console.error("âŒ No plans data received:",t),alert(`Failed to load plans: ${t.error||t.message||"Unknown error"}`)),l&&l.success&&f(l)}catch(s){console.error("Initialization error:",s),alert("Error loading plans: "+s.message)}finally{g(!1)}},N=async s=>{c(!0),d(s.id);try{const r=await i.createOrder(s.id);if(!r.success)throw new Error("Failed to create order");await i.openRazorpayModal(r,async t=>{try{(await i.verifyPayment({razorpay_order_id:t.razorpay_order_id,razorpay_payment_id:t.razorpay_payment_id,razorpay_signature:t.razorpay_signature})).success?(alert("ðŸŽ‰ Payment successful! Your subscription is now active."),window.close()):alert("Payment verification failed. Please contact support.")}catch{alert("Payment verification failed. Please contact support.")}finally{c(!1),d(null)}},t=>{console.error("Payment error:",t),alert("Payment was cancelled or failed"),c(!1),d(null)})}catch(r){console.error("Purchase error:",r),alert(r.message||"Failed to process payment"),c(!1),d(null)}},j=s=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(s),v=s=>new Intl.NumberFormat("en-IN").format(s);return p?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-[#6FBADB] via-[#5AB0D4] to-[#4A9FCD] flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-[#6FBADB] mx-auto"}),e.jsx("p",{className:"text-center mt-4 text-gray-600 font-medium",children:"Loading..."})]})}):e.jsx("div",{className:"min-h-screen w-screen bg-gradient-to-br from-[#6FBADB] via-[#5AB0D4] to-[#4A9FCD] py-4 px-8 overflow-x-hidden",children:e.jsxs("div",{className:"w-full min-w-full",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 bg-white/20 backdrop-blur-sm rounded-full mb-2 shadow-2xl",children:e.jsx("div",{className:"text-3xl",children:"ðŸš€"})}),e.jsx("h1",{className:"text-2xl font-bold text-white mb-1",children:"Choose Your Plan"}),e.jsx("p",{className:"text-sm text-white/90",children:"Start extracting leads and grow your business"})]}),o&&e.jsx("div",{className:"bg-white rounded-lg p-2.5 mb-4 max-w-xs mx-auto shadow-lg",children:e.jsxs("div",{className:"flex items-center gap-2.5",children:[o.picture&&e.jsx("img",{src:o.picture,alt:o.name,className:"w-9 h-9 rounded-full border-2 border-[#6FBADB]"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-gray-900 truncate text-sm",children:o.name}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:o.email})]})]})}),e.jsxs("div",{className:"w-full",children:[e.jsx("h2",{className:"text-xl font-bold text-white text-center mb-4",children:m!=null&&m.hasActiveSubscription?"Upgrade Your Plan":"Choose Your Premium Plan"}),x.length===0?e.jsxs("div",{className:"bg-white rounded-2xl p-8 text-center shadow-xl max-w-2xl mx-auto",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“¦"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No Plans Available"}),e.jsx("p",{className:"text-gray-600",children:"Please contact support or try again later."}),e.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"If this persists, please check the browser console (F12) for errors."})]}):e.jsx("div",{className:"flex gap-5 w-full",children:x.map(s=>e.jsxs("div",{className:"flex-1 bg-white rounded-xl p-5 shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-[1.02] flex flex-col min-w-0",children:[e.jsxs("div",{className:"text-center mb-3 flex-grow",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:s.name}),e.jsx("p",{className:"text-xs text-gray-600 mb-3 line-clamp-2",children:s.description}),e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-3xl font-bold text-[#6FBADB]",children:j(s.price)}),e.jsx("span",{className:"text-sm text-gray-600",children:"/month"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-[#6FBADB]/10 to-[#4A9FCD]/10 rounded-lg p-3 mb-3",children:[e.jsx("p",{className:"text-2xl font-bold text-[#6FBADB]",children:v(s.lead_limit)}),e.jsx("p",{className:"text-xs text-gray-700",children:"Leads per month"})]})]}),s.features&&(()=>{try{const r=typeof s.features=="string"?JSON.parse(s.features):s.features;return e.jsx("ul",{className:"space-y-2 mb-4 text-left",children:r.map((t,l)=>e.jsxs("li",{className:"flex items-start gap-2 text-xs",children:[e.jsx("svg",{className:"w-4 h-4 text-emerald-500 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsx("span",{className:"text-gray-700",children:t})]},l))})}catch(r){return console.error("Error parsing features:",r,s.features),null}})(),e.jsx("button",{onClick:()=>N(s),disabled:b,className:"w-full bg-gradient-to-r from-[#6FBADB] to-[#4A9FCD] text-white rounded-lg px-4 py-2.5 text-sm font-bold hover:shadow-xl transition-all duration-300 transform hover:scale-105 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed mt-auto",children:w===s.id?"Processing...":"Select Plan"})]},s.id))})]}),e.jsxs("div",{className:"text-center mt-6 text-white",children:[e.jsxs("p",{className:"text-xs mb-1",children:["Need help?"," ",e.jsx("a",{href:"mailto:support@blutec.com",className:"font-bold hover:underline",children:"support@blutec.com"})]}),e.jsx("p",{className:"text-xs opacity-75",children:"Secure payments powered by Razorpay"})]})]})})};P.createRoot(document.getElementById("root")).render(e.jsx(A.StrictMode,{children:e.jsx(S,{})}));
